
============= Initialized Observation Utils with Obs Spec =============

using obs modality: low_dim with keys: ['robot0_eef_quat', 'robot0_eef_pos', 'object', 'robot0_gripper_qpos']
using obs modality: rgb with keys: []
using obs modality: depth with keys: []
using obs modality: scan with keys: []

============= Loaded Environment Metadata =============
obs key object with shape (56,)
obs key robot0_eef_pos with shape (3,)
obs key robot0_eef_quat with shape (4,)
obs key robot0_gripper_qpos with shape (2,)
[1m[33m[robosuite WARNING] [0mNo private macro file found! (macros.py:53)
[1m[33m[robosuite WARNING] [0mIt is recommended to use a private macro file (macros.py:54)
[1m[33m[robosuite WARNING] [0mTo setup, run: python /home/wjung85/Repo/exp/robosuite/robosuite/scripts/setup_macros.py (macros.py:55)
Created environment with name PickPlace
Action size is 7
PickPlace
{
    "camera_depths": false,
    "camera_heights": 84,
    "camera_widths": 84,
    "control_freq": 20,
    "controller_configs": {
        "control_delta": true,
        "damping": 1,
        "damping_limits": [
            0,
            10
        ],
        "impedance_mode": "fixed",
        "input_max": 1,
        "input_min": -1,
        "interpolation": null,
        "kp": 150,
        "kp_limits": [
            0,
            300
        ],
        "orientation_limits": null,
        "output_max": [
            0.05,
            0.05,
            0.05,
            0.5,
            0.5,
            0.5
        ],
        "output_min": [
            -0.05,
            -0.05,
            -0.05,
            -0.5,
            -0.5,
            -0.5
        ],
        "position_limits": null,
        "ramp_ratio": 0.2,
        "type": "OSC_POSE",
        "uncouple_pos_ori": true
    },
    "has_offscreen_renderer": true,
    "has_renderer": false,
    "ignore_done": true,
    "render_gpu_device_id": 0,
    "reward_shaping": false,
    "robots": [
        "Panda"
    ],
    "use_camera_obs": false,
    "use_object_obs": true
}

number of parameters: 72.50M

============= Model Summary =============
ACT (
  ModuleDict(
    (policy): DETRVAE(
      (transformer): Transformer(
        (encoder): TransformerEncoder(
          (layers): ModuleList(
            (0-3): 4 x TransformerEncoderLayer(
              (self_attn): MultiheadAttention(
                (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
              )
              (linear1): Linear(in_features=512, out_features=3200, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (linear2): Linear(in_features=3200, out_features=512, bias=True)
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (dropout1): Dropout(p=0.1, inplace=False)
              (dropout2): Dropout(p=0.1, inplace=False)
            )
          )
        )
        (decoder): TransformerDecoder(
          (layers): ModuleList(
            (0-6): 7 x TransformerDecoderLayer(
              (self_attn): MultiheadAttention(
                (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
              )
              (multihead_attn): MultiheadAttention(
                (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
              )
              (linear1): Linear(in_features=512, out_features=3200, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (linear2): Linear(in_features=3200, out_features=512, bias=True)
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (norm3): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (dropout1): Dropout(p=0.1, inplace=False)
              (dropout2): Dropout(p=0.1, inplace=False)
              (dropout3): Dropout(p=0.1, inplace=False)
            )
          )
          (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        )
      )
      (encoder): TransformerEncoder(
        (layers): ModuleList(
          (0-3): 4 x TransformerEncoderLayer(
            (self_attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
            )
            (linear1): Linear(in_features=512, out_features=3200, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
            (linear2): Linear(in_features=3200, out_features=512, bias=True)
            (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (dropout1): Dropout(p=0.1, inplace=False)
            (dropout2): Dropout(p=0.1, inplace=False)
          )
        )
      )
      (action_head): Linear(in_features=512, out_features=7, bias=True)
      (is_pad_head): Linear(in_features=512, out_features=1, bias=True)
      (query_embed): Embedding(16, 512)
      (input_proj_robot_state): Linear(in_features=65, out_features=512, bias=True)
      (input_proj_env_state): Linear(in_features=10, out_features=512, bias=True)
      (pos): Embedding(2, 512)
      (cls_embed): Embedding(1, 512)
      (encoder_action_proj): Linear(in_features=7, out_features=512, bias=True)
      (encoder_joint_proj): Linear(in_features=65, out_features=512, bias=True)
      (latent_proj): Linear(in_features=512, out_features=64, bias=True)
      (latent_out_proj): Linear(in_features=32, out_features=512, bias=True)
      (additional_pos_embed): Embedding(2, 512)
    )
  )
)


============= Training Dataset =============
SequenceDataset (
	path=/home/wjung85/Repo/projects/robomimic-safediffusion/datasets/breadpickplace/franka_bread_final.hdf5
	obs_keys=('object', 'robot0_eef_pos', 'robot0_eef_quat', 'robot0_gripper_qpos')
	seq_length=16
	filter_key=none
	frame_stack=1
	pad_seq_length=True
	pad_frame_stack=True
	goal_mode=none
	cache_mode=none
	num_demos=100
	num_sequences=21696
)

SequenceDataset: normalizing actions...
  0%|                                                                                                                                        | 0/99 [00:00<?, ?it/s]100%|#############################################################################################################################| 99/99 [00:00<00:00, 8094.27it/s]
**************************************************
Warnings generated by robomimic have been duplicated here (from above) for convenience. Please check them carefully.
[33mROBOMIMIC WARNING(
    No private macro file found!
    It is recommended to use a private macro file
    To setup, run: python /home/wjung85/Repo/projects/robomimic-safediffusion/robomimic/scripts/setup_macros.py
)[0m
**************************************************

  0%|                                                                                                                                       | 0/100 [00:00<?, ?it/s]ObservationKeyToModalityDict: pad_mask not found, adding pad_mask to mapping with assumed low_dim modality!
  1%|#2                                                                                                                             | 1/100 [00:00<00:22,  4.36it/s]  2%|##5                                                                                                                            | 2/100 [00:00<00:16,  5.84it/s]  3%|###8                                                                                                                           | 3/100 [00:00<00:13,  7.01it/s]  4%|#####                                                                                                                          | 4/100 [00:00<00:12,  7.78it/s]  5%|######3                                                                                                                        | 5/100 [00:00<00:11,  8.24it/s]  6%|#######6                                                                                                                       | 6/100 [00:00<00:10,  8.59it/s]  7%|########8                                                                                                                      | 7/100 [00:00<00:10,  8.78it/s]  8%|##########1                                                                                                                    | 8/100 [00:01<00:10,  8.96it/s]  9%|###########4                                                                                                                   | 9/100 [00:01<00:10,  9.01it/s] 10%|############6                                                                                                                 | 10/100 [00:01<00:09,  9.11it/s] 11%|#############8                                                                                                                | 11/100 [00:01<00:09,  9.14it/s] 12%|###############1                                                                                                              | 12/100 [00:01<00:09,  9.16it/s] 13%|################3                                                                                                             | 13/100 [00:01<00:09,  9.16it/s] 14%|#################6                                                                                                            | 14/100 [00:01<00:09,  9.23it/s] 15%|##################9                                                                                                           | 15/100 [00:01<00:09,  9.21it/s] 16%|####################1                                                                                                         | 16/100 [00:01<00:09,  9.20it/s] 17%|#####################4                                                                                                        | 17/100 [00:01<00:09,  9.20it/s] 18%|######################6                                                                                                       | 18/100 [00:02<00:08,  9.21it/s] 19%|#######################9                                                                                                      | 19/100 [00:02<00:08,  9.22it/s] 20%|#########################2                                                                                                    | 20/100 [00:02<00:08,  9.23it/s] 21%|##########################4                                                                                                   | 21/100 [00:02<00:08,  9.23it/s] 22%|###########################7                                                                                                  | 22/100 [00:02<00:08,  9.22it/s] 23%|############################9                                                                                                 | 23/100 [00:02<00:08,  9.26it/s] 24%|##############################2                                                                                               | 24/100 [00:02<00:08,  9.24it/s] 25%|###############################5                                                                                              | 25/100 [00:02<00:08,  9.23it/s] 26%|################################7                                                                                             | 26/100 [00:02<00:08,  9.14it/s] 27%|##################################                                                                                            | 27/100 [00:03<00:07,  9.15it/s] 28%|###################################2                                                                                          | 28/100 [00:03<00:07,  9.18it/s] 29%|####################################5                                                                                         | 29/100 [00:03<00:07,  9.19it/s] 30%|#####################################8                                                                                        | 30/100 [00:03<00:07,  9.21it/s] 31%|#######################################                                                                                       | 31/100 [00:03<00:07,  9.21it/s] 32%|########################################3                                                                                     | 32/100 [00:03<00:07,  9.23it/s] 33%|#########################################5                                                                                    | 33/100 [00:03<00:07,  9.21it/s] 34%|##########################################8                                                                                   | 34/100 [00:03<00:07,  9.23it/s] 35%|############################################                                                                                  | 35/100 [00:03<00:07,  9.22it/s] 36%|#############################################3                                                                                | 36/100 [00:04<00:06,  9.23it/s] 37%|##############################################6                                                                               | 37/100 [00:04<00:06,  9.23it/s] 38%|###############################################8                                                                              | 38/100 [00:04<00:06,  9.22it/s] 39%|#################################################1                                                                            | 39/100 [00:04<00:06,  9.21it/s] 40%|##################################################4                                                                           | 40/100 [00:04<00:06,  9.20it/s] 41%|###################################################6                                                                          | 41/100 [00:04<00:06,  9.21it/s] 42%|####################################################9                                                                         | 42/100 [00:04<00:06,  9.21it/s] 43%|######################################################1                                                                       | 43/100 [00:04<00:06,  9.21it/s] 44%|#######################################################4                                                                      | 44/100 [00:04<00:06,  9.20it/s] 45%|########################################################7                                                                     | 45/100 [00:05<00:05,  9.21it/s] 46%|#########################################################9                                                                    | 46/100 [00:05<00:05,  9.18it/s] 47%|###########################################################2                                                                  | 47/100 [00:05<00:05,  9.08it/s] 48%|############################################################4                                                                 | 48/100 [00:05<00:05,  9.14it/s] 49%|#############################################################7                                                                | 49/100 [00:05<00:05,  9.19it/s] 50%|###############################################################                                                               | 50/100 [00:05<00:05,  9.21it/s] 51%|################################################################2                                                             | 51/100 [00:05<00:05,  9.21it/s] 52%|#################################################################5                                                            | 52/100 [00:05<00:05,  9.04it/s] 53%|##################################################################7                                                           | 53/100 [00:05<00:05,  9.07it/s] 54%|####################################################################                                                          | 54/100 [00:06<00:05,  9.13it/s] 55%|#####################################################################3                                                        | 55/100 [00:06<00:04,  9.15it/s] 56%|######################################################################5                                                       | 56/100 [00:06<00:04,  9.12it/s] 57%|#######################################################################8                                                      | 57/100 [00:06<00:04,  9.02it/s] 58%|#########################################################################                                                     | 58/100 [00:06<00:04,  9.05it/s] 59%|##########################################################################3                                                   | 59/100 [00:06<00:04,  9.11it/s] 60%|###########################################################################6                                                  | 60/100 [00:06<00:04,  9.14it/s] 61%|############################################################################8                                                 | 61/100 [00:06<00:04,  9.10it/s] 62%|##############################################################################1                                               | 62/100 [00:06<00:04,  8.98it/s] 63%|###############################################################################3                                              | 63/100 [00:07<00:04,  9.03it/s] 64%|################################################################################6                                             | 64/100 [00:07<00:03,  9.10it/s] 65%|#################################################################################9                                            | 65/100 [00:07<00:03,  9.18it/s] 66%|###################################################################################1                                          | 66/100 [00:07<00:03,  9.07it/s] 67%|####################################################################################4                                         | 67/100 [00:07<00:03,  9.00it/s] 68%|#####################################################################################6                                        | 68/100 [00:07<00:03,  9.06it/s] 69%|######################################################################################9                                       | 69/100 [00:07<00:03,  9.13it/s] 70%|########################################################################################1                                     | 70/100 [00:07<00:03,  9.03it/s] 71%|#########################################################################################4                                    | 71/100 [00:07<00:03,  9.02it/s] 72%|##########################################################################################7                                   | 72/100 [00:07<00:03,  9.09it/s] 73%|###########################################################################################9                                  | 73/100 [00:08<00:02,  9.13it/s] 74%|#############################################################################################2                                | 74/100 [00:08<00:02,  9.17it/s] 75%|##############################################################################################5                               | 75/100 [00:08<00:02,  9.18it/s] 76%|###############################################################################################7                              | 76/100 [00:08<00:02,  9.17it/s] 77%|#################################################################################################                             | 77/100 [00:08<00:02,  8.98it/s] 78%|##################################################################################################2                           | 78/100 [00:08<00:02,  8.96it/s] 79%|###################################################################################################5                          | 79/100 [00:08<00:02,  9.02it/s] 80%|####################################################################################################8                         | 80/100 [00:08<00:02,  9.08it/s] 81%|######################################################################################################                        | 81/100 [00:08<00:02,  9.10it/s] 82%|#######################################################################################################3                      | 82/100 [00:09<00:01,  9.01it/s] 83%|########################################################################################################5                     | 83/100 [00:09<00:01,  9.15it/s] 84%|#########################################################################################################8                    | 84/100 [00:09<00:01,  9.19it/s] 85%|###########################################################################################################1                  | 85/100 [00:09<00:01,  9.19it/s] 86%|############################################################################################################3                 | 86/100 [00:09<00:01,  9.20it/s] 87%|#############################################################################################################6                | 87/100 [00:09<00:01,  9.18it/s] 88%|##############################################################################################################8               | 88/100 [00:09<00:01,  9.05it/s] 89%|################################################################################################################1             | 89/100 [00:09<00:01,  9.05it/s] 90%|#################################################################################################################4            | 90/100 [00:09<00:01,  9.09it/s] 91%|##################################################################################################################6           | 91/100 [00:10<00:00,  9.14it/s] 92%|###################################################################################################################9          | 92/100 [00:10<00:00,  9.16it/s] 93%|#####################################################################################################################1        | 93/100 [00:10<00:00,  9.09it/s] 94%|######################################################################################################################4       | 94/100 [00:10<00:00,  9.15it/s] 95%|#######################################################################################################################7      | 95/100 [00:10<00:00,  9.18it/s] 96%|########################################################################################################################9     | 96/100 [00:10<00:00,  9.20it/s] 97%|##########################################################################################################################2   | 97/100 [00:10<00:00,  9.21it/s] 98%|###########################################################################################################################4  | 98/100 [00:10<00:00,  9.24it/s] 99%|############################################################################################################################7 | 99/100 [00:10<00:00,  9.23it/s]100%|#############################################################################################################################| 100/100 [00:11<00:00,  9.22it/s]100%|#############################################################################################################################| 100/100 [00:11<00:00,  9.04it/s]
Train Epoch 1
{
    "KL_Loss": 0.47903274893760683,
    "Loss": 9.871408004760742,
    "Optimizer/policy0_lr": 5e-05,
    "Policy_Grad_Norms": 114642.16455731161,
    "Reconstruction_Loss": 0.2907531248033047,
    "Time_Data_Loading": 0.05398297309875488,
    "Time_Epoch": 0.1842983881632487,
    "Time_Log_Info": 0.019284900029500326,
    "Time_Process_Batch": 0.01376192569732666,
    "Time_Train_Batch": 0.09663952986399332
}
video writes to /home/wjung85/Repo/projects/robomimic-safediffusion/diffusion_policy_trained_models/breadpickplace_act/first_trial/20240831134457/videos/PickPlace_epoch_1.mp4
rollout: env=PickPlace, horizon=400, use_goals=False, num_episodes=10
  0%|                                                                                                                                        | 0/10 [00:00<?, ?it/s]Backend TkAgg is interactive backend. Turning interactive mode on.
